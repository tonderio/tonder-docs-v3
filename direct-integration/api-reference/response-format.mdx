---
title: "Response Format"
sidebarTitle: "Response Format"
'og:description': ""
---

All Tonder API responses follow a consistent structure, providing standardized information regardless of the operation type (payment or withdrawal). This consistency simplifies integration and error handling across different transaction types.

## Standard Response Structure

All successful requests return a consistent response format:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "operation_type": "payment",
  "status": "authorized",
  "amount": 150.00,
  "currency": "MXN",
  "client_reference": "order-789",
  "payment_id": 12345,
  "transaction_id": "txn_abc123",
  "provider": "stripe",
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 201
}
```

Where:

| Field              | Type    | Description                            |
| ------------------ | ------- | -------------------------------------- |
| `id`               | string  | Unique transaction identifier (UUID)   |
| `operation_type`   | string  | `"payment"` or `"withdrawal"`          |
| `status`           | string  | Current transaction status             |
| `amount`           | decimal | Transaction amount                     |
| `currency`         | string  | Currency code (e.g., `"MXN"`, `"USD"`) |
| `client_reference` | string  | Your reference identifier              |
| `created_at`       | string  | ISO 8601 timestamp of creation         |
| `status_code`      | integer | HTTP status code                       |

## Transaction Status Values

The `status` field can have the following values:

| Status             | Label            | Description                            | Next Steps                        |
| ------------------ | ---------------- | -------------------------------------- | --------------------------------- |
| `pending`          | Pending          | Transaction awaiting completion        | Check status or wait for webhook  |
| `on_hold`          | On hold          | Transaction temporarily held           | Wait for review completion        |
| `processing`       | Processing       | Transaction being processed            | Monitor for completion            |
| `sent_to_provider` | Sent to provider | Sent to payment provider               | Monitor for completion            |
| `success`          | Success          | Transaction successfully completed     | Transaction complete              |
| `paid_full`        | Paid in full     | Payment completed in full              | Transaction complete              |
| `in_transit`       | In transit       | Payment in transit to destination      | Monitor for completion            |
| `canceled`         | Canceled         | Transaction was cancelled              | No further action required        |
| `declined`         | Declined         | Payment declined by provider or issuer | Try different payment method      |
| `rejected`         | Rejected         | Transaction was rejected               | Try different payment method      |
| `failed`           | Failed           | Transaction processing failed          | Check error details and retry     |
| `Unknown`          | Unknown          | Status cannot be determined            | Contact support for clarification |
| `expired`          | Expired          | Transaction or authorization expired   | Create new transaction if needed  |
| `authorized`       | Authorized       | Payment authorized (cards only)        | Transaction complete              |

## Payment Response Examples

Here are some examples of payment responses.

<AccordionGroup>

<Accordion title="Card Payment Response">

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "operation_type": "payment",
  "status": "authorized",
  "amount": 150.00,
  "currency": "MXN",
  "client_reference": "order-789",
  "payment_id": 12345,
  "transaction_id": "txn_abc123",
  "provider": "stripe",
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 201
}
```

</Accordion>

<Accordion title="SPEI Payment Response">

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440001",
  "operation_type": "payment",
  "status": "processing",
  "amount": 500.00,
  "currency": "MXN",
  "client_reference": "invoice-456",
  "payment_id": 12346,
  "transaction_id": "txn_def456",
  "provider": "stp",
  "created_at": "2024-07-26T10:35:00Z",
  "status_code": 201
}
```

</Accordion>

<Accordion title="SPEI Withdrawal Response">

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440002",
  "operation_type": "withdrawal",
  "status": "processing",
  "amount": 750.00,
  "currency": "MXN",
  "client_reference": "payout-001",
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 201
}
```

</Accordion>

<Accordion title="Debit Card Withdrawal Response">

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440003",
  "operation_type": "withdrawal",
  "status": "processing",
  "amount": 500.00,
  "currency": "MXN",
  "client_reference": "card-payout-002",
  "created_at": "2024-07-26T11:15:00Z",
  "status_code": 201
}
```

</Accordion>

</AccordionGroup>

## Next Action Handling

Some transactions require additional steps (3D Secure, redirects, iframe interactions). The `next_action` object will contain specific instructions for handling these scenarios.

Here are some examples of responses that require additional action.

<AccordionGroup>

<Accordion title="Redirect to URL (3DS Authentication)">

For card payments requiring 3D Secure authentication:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "operation_type": "payment",
  "status": "pending",
  "amount": 150.00,
  "currency": "MXN",
  "next_action": {
    "redirect_to_url": {
      "url": "https://secure.payment-provider.com/3ds/abc123",
      "return_url": "https://yoursite.com/payment/return",
      "verify_transaction_status_url": "/api/v1/stripe/business/123/payments/456/transactions/789"
    }
  },
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 202
}
```

**Implementation Steps:**

1. Redirect customer to the provided `url`
2. Customer completes 3DS authentication
3. Customer is redirected back to your `return_url`
4. Check transaction status using the `verify_transaction_status_url`

</Accordion>

<Accordion title="Iframe Resources (MercadoPago)">

For providers requiring iframe-based authentication:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "operation_type": "payment",
  "status": "pending",
  "amount": 150.00,
  "currency": "MXN",
  "next_action": {
    "iframe_resources": {
      "return_url": "https://yoursite.com/payment/return",
      "verify_transaction_status_url": "/api/v1/mercadopago/business/123/payments/456/transactions/789",
      "external_resource_url": "https://mercadopago.com/3ds/challenge",
      "creq": "challenge_request_data"
    }
  },
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 202
}
```

</Accordion>

</AccordionGroup>

## Payment Instructions Response

For cash payment methods (OXXO, SafetyPay), the response includes detailed payment instructions:

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "operation_type": "payment",
  "status": "pending",
  "amount": 250.00,
  "currency": "MXN",
  "payment_instructions": {
    "reference_code": "99900012345678",
    "barcode": "||99900012345678||",
    "store_name": "OXXO",
    "expiration_date": "2024-07-29T23:59:59Z",
    "instructions": [
      "Acude a cualquier tienda OXXO",
      "Presenta este c√≥digo de barras en caja",
      "Paga exactamente $250.00 MXN en efectivo"
    ]
  },
  "voucher_pdf": "https://api.tonder.io/vouchers/abc123.pdf",
  "created_at": "2024-07-26T10:30:00Z",
  "status_code": 201
}
```

### Payment Instructions Fields

The following table lists the fields that are included in the `payment_instructions` object.

| Field             | Type   | Description                         |
| ----------------- | ------ | ----------------------------------- |
| `reference_code`  | string | Payment reference for cash payment  |
| `barcode`         | string | Barcode representation              |
| `store_name`      | string | Store chain name (e.g., "OXXO")     |
| `expiration_date` | string | Payment expiration timestamp        |
| `instructions`    | array  | Step-by-step payment instructions   |
| `voucher_pdf`     | string | URL to downloadable payment voucher |

## HTTP Status Codes

The following tables lists the HTTP status codes that are returned by the API.

### Success Codes

| Code | Description | When Used                                        |
| ---- | ----------- | ------------------------------------------------ |
| 200  | OK          | Status check successful                          |
| 201  | Created     | Transaction created successfully                 |
| 202  | Accepted    | Transaction accepted, requires additional action |

### Client Error Codes

| Code | Description      | Action Required      |
| ---- | ---------------- | -------------------- |
| 400  | Bad Request      | Fix request format   |
| 401  | Unauthorized     | Check authentication |
| 402  | Payment Required | Payment declined     |
| 404  | Not Found        | Check transaction ID |
| 422  | Validation Error | Fix request data     |
| 429  | Rate Limited     | Retry with backoff   |

### Server Error Codes

| Code | Description           | Action Required |
| ---- | --------------------- | --------------- |
| 500  | Internal Server Error | Retry request   |
| 502  | Bad Gateway           | Retry request   |
| 503  | Service Unavailable   | Retry later     |

## Response Headers

All responses include standard headers for debugging and rate limiting:

```http
HTTP/1.1 201 Created
Content-Type: application/json
X-Request-ID: req_abc123
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1640995200
```

The following table provides a description of the headers that are included in the response.

| Header                  | Description                             |
| ----------------------- | --------------------------------------- |
| `X-Request-ID`          | Unique request identifier for debugging |
| `X-RateLimit-Limit`     | Request limit per window                |
| `X-RateLimit-Remaining` | Requests remaining in current window    |
| `X-RateLimit-Reset`     | Unix timestamp when limit resets        |

## Error Response Format

When requests fail, errors follow a consistent format:

```json
{
  "error": {
    "code": "validation_error",
    "message": "Amount must be greater than 0",
    "type": "request_error",
    "details": {
      "field": "amount",
      "received_value": -10.00
    }
  },
  "request_id": "req_abc123"
}
```

Where:

| Field           | Type   | Description                    |
| --------------- | ------ | ------------------------------ |
| `error.code`    | string | Specific error code            |
| `error.message` | string | Human-readable error message   |
| `error.type`    | string | Error category                 |
| `error.details` | object | Additional error context       |
| `request_id`    | string | Request identifier for support |

## Implementation Examples

Here are some examples of how to handle responses in different programming languages.

<CodeGroup>

```python Python
def handle_transaction_response(response):
    """Handle Tonder API response"""
    
    if response.status_code in [200, 201, 202]:
        data = response.json()
        
        # Check if additional action is required
        if 'next_action' in data:
            return handle_next_action(data)
        
        # Check for payment instructions
        if 'payment_instructions' in data:
            return handle_payment_instructions(data)
        
        # Standard successful response
        return {
            'success': True,
            'transaction_id': data['id'],
            'status': data['status'],
            'amount': data['amount']
        }
    
    else:
        # Handle error response
        error_data = response.json()
        return {
            'success': False,
            'error_code': error_data['error']['code'],
            'error_message': error_data['error']['message'],
            'request_id': error_data.get('request_id')
        }

def handle_next_action(response_data):
    """Handle responses requiring additional action"""
    
    next_action = response_data['next_action']
    
    if 'redirect_to_url' in next_action:
        # 3DS redirect required
        return {
            'success': True,
            'requires_action': True,
            'action_type': 'redirect',
            'redirect_url': next_action['redirect_to_url']['url'],
            'return_url': next_action['redirect_to_url']['return_url']
        }
    
    elif 'iframe_resources' in next_action:
        # Iframe authentication required
        return {
            'success': True,
            'requires_action': True,
            'action_type': 'iframe',
            'iframe_url': next_action['iframe_resources']['external_resource_url']
        }
    
    return {'success': False, 'error': 'Unknown next action'}

def handle_payment_instructions(response_data):
    """Handle cash payment instructions"""
    
    instructions = response_data['payment_instructions']
    
    return {
        'success': True,
        'requires_cash_payment': True,
        'reference_code': instructions['reference_code'],
        'store_name': instructions['store_name'],
        'expiration_date': instructions['expiration_date'],
        'voucher_pdf': response_data.get('voucher_pdf'),
        'instructions': instructions['instructions']
    }
```

```java Java
public class ResponseHandler {
    
    public TransactionResult handleResponse(HttpResponse<String> response) {
        try {
            ObjectMapper mapper = new ObjectMapper();
            
            if (response.statusCode() >= 200 && response.statusCode() < 300) {
                Map<String, Object> data = mapper.readValue(response.body(), Map.class);
                
                // Check for next action
                if (data.containsKey("next_action")) {
                    return handleNextAction(data);
                }
                
                // Check for payment instructions
                if (data.containsKey("payment_instructions")) {
                    return handlePaymentInstructions(data);
                }
                
                // Standard successful response
                return TransactionResult.success(
                    (String) data.get("id"),
                    (String) data.get("status"),
                    (Double) data.get("amount")
                );
            
            } else {
                // Handle error response
                Map<String, Object> errorData = mapper.readValue(response.body(), Map.class);
                Map<String, Object> error = (Map<String, Object>) errorData.get("error");
                
                return TransactionResult.error(
                    (String) error.get("code"),
                    (String) error.get("message"),
                    (String) errorData.get("request_id")
                );
            }
            
        } catch (Exception e) {
            return TransactionResult.error("parsing_error", e.getMessage(), null);
        }
    }
    
    private TransactionResult handleNextAction(Map<String, Object> data) {
        Map<String, Object> nextAction = (Map<String, Object>) data.get("next_action");
        
        if (nextAction.containsKey("redirect_to_url")) {
            Map<String, Object> redirect = (Map<String, Object>) nextAction.get("redirect_to_url");
            return TransactionResult.requiresRedirect(
                (String) redirect.get("url"),
                (String) redirect.get("return_url")
            );
        }
        
        return TransactionResult.error("unknown_action", "Unknown next action required", null);
    }
}
```

</CodeGroup>

## Best Practices

Make sure to follow these best practices to handle responses properly.

<AccordionGroup>

<Accordion title="Response Processing">

1. **Always check status code** - Don't assume success based on HTTP 200
2. **Handle next actions** - Process 3DS and iframe requirements properly
3. **Store transaction IDs** - Keep references for status checking
4. **Process payment instructions** - Display cash payment details to customers

</Accordion>

<Accordion title="Error Handling">

1. **Use error codes** - Don't rely on error messages for logic
2. **Log request IDs** - Include in support requests
3. **Implement retries** - For server errors (5xx status codes)
4. **Validate responses** - Check for required fields before processing

</Accordion>

<Accordion title="Status Management">

1. **Monitor pending transactions** - Use webhooks or periodic status checks
2. **Handle status changes** - Update UI based on current status
3. **Set timeouts** - Don't wait indefinitely for completion
4. **Notify customers** - Keep users informed of transaction progress

</Accordion>

</AccordionGroup>

## Next Steps

- [Learn about Status Checking](./transation-status-check) for monitoring transactions
- [Set up Webhooks](../integration/webhooks) for real-time status updates
- [Review Error Handling](../integration/error-handling) for comprehensive error management
- [Check Payment Methods](../payment-processing/payment-methods) for method-specific responses